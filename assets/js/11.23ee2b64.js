(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{537:function(t,e,s){},572:function(t,e,s){"use strict";var a=s(537);s.n(a).a},604:function(t,e,s){"use strict";s.r(e);var a=s(65),i={data:()=>({mode:"search",center:null,zoom:10,query:"",searching:!1,tips:[],results:[],position:null,pageIndex:1,pageSize:10,total:0,satellite:!1}),computed:{wrapper(){return this.$refs.wrapper},positionText(){return this.position?`${this.position[0]}, ${this.position[1]}`:""}},created(){this.$ready=new Promise(async t=>{const e=await Object(a.b)();await Object(a.c)(["AMap.PlaceSearch","AMap.AutoComplete"]),this.ps=new e.PlaceSearch({pageSize:this.pageSize}),this.ac=new e.AutoComplete,t()})},methods:{onMapClick(t){t.lnglat?this.position=[t.lnglat.lng,t.lnglat.lat]:this.position=null},async search(t=!1){this.mode="result",await this._ready,t&&(this.results=[],this.total=0,this.pageIndex=1,this.ps.setPageIndex(1)),this.searching=!0;const{query:e}=this;this.ps.search(e,(t,s)=>{this.searching=!1,e===this.query&&("complete"===t&&s.poiList?(this.results=s.poiList.pois,this.total=s.poiList.count):(this.results=[],this.total=0))})},async autoComplete(t){t?this.ac.search(t,(e,s)=>{t===this.query&&("complete"===e&&s.tips?this.tips=Array.from(new Set(s.tips.map(t=>t.name))):this.tips=[])}):this.tips=[]},focus(t){const e=[t.location.lng,t.location.lat];this.position=[...e],this.center=[...e]},reset(){this.ps.setPageIndex(1),this.results=[],this.tips=[],this.total=0,this.mode="search"}},watch:{pageIndex(t){this.$ready.then(()=>{this.ps.setPageIndex(t),this.search(!1)})}}},o=(s(572),s(64)),l=Object(o.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coord-picker"},[s("div",{staticClass:"map-container"},[s("amap",{attrs:{"cache-key":"coord-picker-map","mmap-style":"amap://styles/whitesmoke",async:"",center:t.center,zoom:t.zoom,"is-hotspot":""},on:{"update:center":function(e){t.center=e},"update:zoom":function(e){t.zoom=e},click:t.onMapClick}},[s("amap-satellite-layer",{attrs:{visible:t.satellite}}),t._v(" "),t.position?s("amap-marker",{attrs:{position:t.position,draggable:""},on:{"update:position":function(e){t.position=e}}}):t._e(),t._v(" "),s("a-card",{staticClass:"result-panel",attrs:{"body-style":{"max-height":"450px","overflow-y":"scroll","padding-top":0}}},[s("template",{slot:"title"},["search"===t.mode?[s("a-input-group",{staticStyle:{display:"flex"},attrs:{compact:""}},[s("a-auto-complete",{staticStyle:{flex:"1"},attrs:{"data-source":t.tips,placeholder:"输入关键词"},on:{search:t.autoComplete},model:{value:t.query,callback:function(e){t.query=e},expression:"query"}}),t._v(" "),s("a-button",{attrs:{disabled:!t.query,type:"primary"},on:{click:function(e){return t.search(!0)}}},[t._v("\n                搜索\n              ")])],1)]:t._e(),t._v(" "),"result"===t.mode?[s("div",{staticClass:"search-bar"},[s("a-button",{staticStyle:{"margin-right":"6px"},attrs:{icon:"left"},on:{click:t.reset}}),t._v(" "),s("span",{staticClass:"text"},[t._v("搜索 "+t._s(t.query)+" 共\n                "+t._s(t.searching?"...":t.total)+" 条结果")])],1)]:t._e()],2),t._v(" "),"result"===t.mode?s("a-list",{staticClass:"result-list",attrs:{"data-source":t.results,loading:t.searching,"item-layout":"vertical",size:"small"},scopedSlots:t._u([{key:"renderItem",fn:function(e){return s("a-list-item",{key:e.id},[s("a-list-item-meta",{attrs:{description:e.address}},[s("span",{staticStyle:{cursor:"pointer"},attrs:{slot:"title"},on:{click:function(s){return t.focus(e)}},slot:"title"},[t._v(t._s(e.name))])])],1)}}],null,!1,3825972152)},[t.total>0?s("a-pagination",{attrs:{slot:"header","page-size":t.pageSize,total:t.total,size:"small"},slot:"header",model:{value:t.pageIndex,callback:function(e){t.pageIndex=e},expression:"pageIndex"}}):t._e(),t._v(" "),t._v(" "),t.total>0?s("a-pagination",{attrs:{slot:"footer","page-size":t.pageSize,total:t.total,size:"small"},slot:"footer",model:{value:t.pageIndex,callback:function(e){t.pageIndex=e},expression:"pageIndex"}}):t._e()],1):t._e()],2),t._v(" "),s("a-form",{staticClass:"info ant-card ant-card-bordered",attrs:{layout:"inline"}},[t.position?s("a-form-item",{attrs:{label:"坐标"}},[s("a-input",{staticStyle:{width:"200px"},attrs:{"read-only":"",value:t.positionText}})],1):t._e(),t._v(" "),s("a-form-item",{attrs:{label:"卫星图"}},[s("a-switch",{model:{value:t.satellite,callback:function(e){t.satellite=e},expression:"satellite"}})],1)],1)],1)],1)])}),[],!1,null,"d7f6a6a6",null);e.default=l.exports}}]);